use priority queue and check greedily